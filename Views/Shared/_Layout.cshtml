<script src="https://lib.arvancloud.ir/html2pdf.js/0.9.3/html2pdf.min.js"></script>
<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - پنل مدیریت راینو</title>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.rtl.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="~/css/styles.css" asp-append-version="true">
        
</head>

<body>
    <div class="d-flex flex-row-reverse min-vh-100">

        <aside class="sidebar-right shadow-lg d-flex flex-column text-white">
            <div class="sidebar-header p-4 border-bottom border-secondary">
                <h4 class="fw-bold mb-0">
                    <i class="bi bi-box-seam-fill text-info me-2"></i> پنل راینو
                </h4>
            </div>

            <div class="sidebar-content overflow-auto flex-grow-1 py-3">
                <div class="mb-4">
                    <small class="text-uppercase text-muted px-4 mb-2 d-block small fw-bold" style="letter-spacing: 1px;">صفحات منتخب</small>
                    <nav class="nav flex-column">
                        <a class="nav-link py-2 px-4 @(ViewContext.RouteData.Values["Action"]?.ToString() == "Index" && ViewContext.RouteData.Values["Controller"]?.ToString() == "Home" ? "active" : "")"
                           asp-controller="Home" asp-action="Index">
                            <i class="bi bi-grid-1x2-fill text-primary ms-2"></i> میز کار مرکزی
                        </a>
                        <a class="nav-link py-2 px-4" href="#"><i class="bi bi-wallet2 text-success ms-2"></i> تنظیمات مالی</a>
                        <a class="nav-link py-2 px-4" href="#"><i class="bi bi-file-earmark-diff text-warning ms-2"></i> صدور سند</a>
                        <a class="nav-link py-2 px-4" href="#"><i class="bi bi-person-badge text-info ms-2"></i> حکم کارگزینی</a>
                    </nav>
                </div>

                <div class="mb-4">
                    <small class="text-uppercase text-muted px-4 mb-2 d-block small fw-bold" style="letter-spacing: 1px;">مدیریت سیستمی</small>
                    <nav class="nav flex-column">
                        <a class="nav-link py-2 px-4 @(ViewContext.RouteData.Values["Controller"]?.ToString() == "Letters" ? "active" : "")"
                           asp-controller="Letters" asp-action="Index">
                            <i class="bi bi-envelope text-danger ms-2"></i> مدیریت نامه‌ها
                        </a>
                        <a class="nav-link py-2 px-4 @(ViewContext.RouteData.Values["Controller"]?.ToString() == "Leaves" ? "active" : "")"
                           asp-controller="Leaves" asp-action="Index">
                            <i class="bi bi-calendar-check text-success ms-2"></i> درخواست مرخصی
                        </a>
                        <a class="nav-link py-2 px-4" href="#"><i class="bi bi-people text-info ms-2"></i> سرمایه انسانی</a>
                        <a class="nav-link py-2 px-4" href="#"><i class="bi bi-person-walking text-warning ms-2"></i> مدیریت تردد</a>
                        <a class="nav-link py-2 px-4" href="#"><i class="bi bi-chat-square-text-fill text-primary ms-2"></i> سامانه پیامکی</a>
                        <a class="nav-link py-2 px-4" href="#"><i class="bi bi-chat-square-text-fill text-primary ms-2"></i> چت سازمانی</a>

                        <a class="nav-link py-2 px-4" href="#"><i class="bi bi-stars text-purple ms-2"></i> چت با هوش مصنوعی</a>

                        <a class="nav-link py-2 px-4" href="#"><i class="bi bi-truck text-warning ms-2"></i> ثبت بارنامه</a>

                        <a class="nav-link py-2 px-4" href="#"><i class="bi bi-cash-stack text-success ms-2"></i> ارسال کارکرد لیست حقوق</a>

                        <a class="nav-link py-2 px-4" href="#"><i class="bi bi-shield-check text-info ms-2"></i> ارسال کارکرد لیست بیمه</a>
                            <a class="nav-link py-2 px-4" asp-controller="Settings" asp-action="Index">
                                <i class="bi bi-gear text-secondary ms-2"></i> تنظیمات سیستم
                            </a>
                    </nav>
                </div>
            </div>

            <div class="sidebar-footer p-3 border-top border-secondary">
                @await Html.PartialAsync("_LoginPartial")
            </div>
        </aside>

        <main class="main-content flex-grow-1 d-flex flex-column">
            <div class="container-fluid py-2 flex-grow-1">
                @RenderBody()
            </div>

            <footer class="bg-transparent py-3 text-center">
                <small class="text-muted">طراحی شده برای پورتال سازمانی راینو &copy; 2026</small>
            </footer>
        </main>

    </div>

    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.7/js/dataTables.bootstrap5.min.js"></script>

    <script>
            $(document).ready(function() {
            // فقط جدول‌هایی را دیتاتیبل کن که کلاس 'dt-skip' ندارند
            // اینطوری هر جدولی که بخوایم خودمون دستی مدیریت کنیم، تداخل ایجاد نمیکنه
            $('.table:not(.dt-skip)').each(function() {
                if (!$.fn.DataTable.isDataTable(this)) {
                    $(this).DataTable({
                        "language": { "url": "https://cdn.datatables.net/plug-ins/1.13.7/i18n/fa.json" },
                        "pageLength": 10,
                        "lengthMenu": [5, 10, 25],
                        "retrieve": true // این خط جلوی ارور رو میگیره
                    });
                }
            });
        });
    </script>
    @await RenderSectionAsync("Scripts", required: false)
    <script>
               function updatePersianDateTime() {
            const now = new Date();
            const dateOptions = { year: 'numeric', month: 'long', day: 'numeric' };
            const persianDate = now.toLocaleDateString('fa-IR', dateOptions);
            const timeOptions = { hour: '2-digit', minute: '2-digit' };
            const persianTime = now.toLocaleTimeString('fa-IR', timeOptions);

            // اضافه کردن شرط برای جلوگیری از ارور
            const dateEl = document.getElementById('current-persian-date');
            const timeEl = document.getElementById('current-time-persian');

            if (dateEl) dateEl.innerHTML = "امروز: " + persianDate;
            if (timeEl) timeEl.innerHTML = "ساعت " + persianTime;
        }

        // اجرا هنگام لود
        updatePersianDateTime();

        // آپدیت هر یک دقیقه برای دقیق ماندن ساعت
        setInterval(updatePersianDateTime, 60000);
    </script>
    <script>
        function setDailyBackground() {
            // لیست عکس‌هایی که دانلود کرده‌ای
            const bgImages = [
                '/images/backgrounds/bg-1.jpg',
                '/images/backgrounds/bg-2.jpg',
                '/images/backgrounds/bg-3.jpg',
                '/images/backgrounds/bg-4.jpg',
                '/images/backgrounds/bg-5.jpg',
                '/images/backgrounds/bg-6.jpg',
                '/images/backgrounds/bg-7.jpg',
                '/images/backgrounds/bg-8.jpg'
            ];

            // پیدا کردن روزِ سال (۱ تا ۳۶۵)
            const now = new Date();
            const start = new Date(now.getFullYear(), 0, 0);
            const diff = now - start;
            const oneDay = 1000 * 60 * 60 * 24;
            const dayOfYear = Math.floor(diff / oneDay);

            // انتخاب عکس بر اساس روز (باقیمانده تقسیم بر تعداد عکس‌ها)
            const selectedImage = bgImages[dayOfYear % bgImages.length];

            // اعمال عکس به Body
            document.body.style.backgroundImage = `url('${selectedImage}')`;
        }

        // اجرا هنگام لود صفحه
        setDailyBackground();
            
    </script>
</body>
</html>